% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.r
\name{plot_sd}
\alias{plot_sd}
\title{Creates plot of model results (uncertainties optional)}
\usage{
plot_sd(
  model_base,
  treatments,
  rs_mean,
  rs_range = NULL,
  obs_mean = NULL,
  obs_full = NULL,
  x_breaks = NULL,
  y_lim = NULL,
  grid_labels = NULL,
  grid_ncol = 2,
  plot_col = 2,
  y_title = NULL,
  ...
)
}
\arguments{
\item{model_base}{effect scenario object with mean parameters}

\item{treatments}{treatments exposure levels as data frame}

\item{rs_mean}{\code{data.frame}, model results best fit params}

\item{rs_range}{\code{data.frame}, uncertainties as data frame}

\item{obs_mean}{\code{data.frame}, observation data with means per treatment level}

\item{obs_full}{\code{data.frame}, full set including results for replicates}

\item{x_breaks}{optional vector of breaks of x-axis}

\item{y_lim}{optional vector containing limits of y-axis}

\item{grid_labels}{optional labels of grid headers}

\item{grid_ncol}{optional number of grid columns}

\item{plot_col}{output column which should be plotted}

\item{y_title}{optional title of y-axis}

\item{...}{any additional parameters}
}
\description{
All parameter combinations and exposure patterns are simulated and the mean
of predicted frond numbers is derived for a single study. The uncertainty is
passed to the function due to computation time. Results are displayed by
plotting the time series including the uncertainty interval. Observation data
can be optionally displayed. Data should be provided in long format.
}
\examples{
\dontrun{
exposure <- structure(list(time = 0:21,
  conc = c(0.0446, 0.0182, 0.007, 0.0563,
         0.1079, 0.047, 0.0193, 0.061, 0.0555, 0.163, 0.1277, 0.1587,
         0.0269, 0.1438, 0.1004, 0.1563, 0.1138, 0.1461, 0.1101, 0.2733,
         0.2752, 0.2772),
  trial = c("T1", "T1", "T1", "T1", "T1", "T1",
          "T1", "T1", "T1", "T1", "T1", "T1", "T1", "T1", "T1", "T1", "T1",
          "T1", "T1", "T1", "T1", "T1")),
  row.names = c(NA, -22L), class = "data.frame")

forcings <- list(temp = structure(list(t = 0, value = 12),
                                  class = "data.frame",
                                  row.names = c(NA, -1L)),
                 rad = structure(list(t = 0, value = 15000),
                                 class = "data.frame",
                                 row.names = c(NA, -1L)))

param <- list(Emax = 0.784, AperBM = 1000, Kbm = 0.75, P_Temp = FALSE,
              MolWeight = 381, k_phot_fix = FALSE, k_phot_max = 0.47, k_resp = 0.05,
              k_loss = 0, Tmin = 8, Tmax = 40.5, Topt = 26.7, t_ref = 25,
              Q10 = 2, k_0 = 3, a_k = 5e-05, C_P = 0.3, CP50 = 0.0043,
              a_P = 1, KiP = 101, C_N = 0.6, CN50 = 0.034, a_N = 1, KiN = 604,
              BM50 = 176, mass_per_frond = 1e-04, BMw2BMd = 16.7, EC50 = 0.3,
              b = 4.16, P_up = 0.0054)
inits <- list(BM = 0.0012, E = 1, M_int = 0)

model_input <- cvasi::Lemna_Schmitt() \%>\%
  cvasi::set_forcings(forcings) \%>\%
  cvasi::set_param(param) \%>\%
  cvasi::set_init(inits)

sim_result <- cvasi::simulate_batch(model_base = model_input,
                                    treatments = exposure,
                                    param_sample = NULL)


cvasi::plot_sd(model_base = model_input,
               treatments = exposure,
               rs_mean = sim_result,
               obs_mean = NULL,
               x_breaks = axisTicks(
                 usr = range(exposure[,"time"]),
                 log = FALSE,
                 axp = NULL,
                 nint = 5)
)
}
}
